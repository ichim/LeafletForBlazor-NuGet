@page "/"

<button onclick="@clearAllCharts">Clear all charts</button>
<RealTimeMap @ref="rtm" Parameters="@loadParameters" height="calc(100vh - 6rem)" width="calc(100vw - 18rem)" OnAfterMapLoaded="@onAfterMapLoaded" />


@code {
    RealTimeMap rtm;
    RealTimeMap.LoadParameters loadParameters = new RealTimeMap.LoadParameters()
    {
        location = new RealTimeMap.Location()
        {
            latitude = 51.02094731770253,
            longitude = 4.523290395225346,
        },
        zoomLevel = 10
    };
    private async Task onAfterMapLoaded(RealTimeMap.MapEventArgs args)
    {
        List<RealTimeMap.DonutChartPoint> charts = new List<RealTimeMap.DonutChartPoint>();
        charts.Add(new RealTimeMap.DonutChartPoint()
        {
            location = new RealTimeMap.Location()
            {
                latitude = 50.85073773727975,
                longitude = 4.357868777032773
            },
            values = (new List<double>() { 15, 45, 20, 20 }).ToArray(),
            colors = (new List<string>() { "#32cd32", "#ffe4c4", "#dda0dd", "pink" }).ToArray(),
            labels = (new List<string>() { "Dacia", "Pegeut", "Audi", "Mini" }).ToArray(),
            expandedIndex = 0,
            fontSize = 10,
            dimension = 40,
            styles = new RealTimeMap.DonutStyle()
            {
                slice = new LeafletForBlazor.css.Style().add("stroke-width", "1").add("stroke", "gray"),
                label = new LeafletForBlazor.css.Style().add("font-style", "italic"),
            },
            visibilityZoomLevel = new RealTimeMap.VisibilityZoomLevel()
            {
                minZoomLevel = 8,
                maxZoomLevel = 14
            }
        });

        List<RealTimeMap.GaugeChartPoint> gaugeCharts = new List<RealTimeMap.GaugeChartPoint>();


        gaugeCharts.Add(new RealTimeMap.GaugeChartPoint()
        {
            location = new RealTimeMap.Location()
            {
                latitude = 51.02094731770253,
                longitude = 4.523290395225346,
            },
            valueStart = 0,
            valueStop = 100,
            value = 82,
            colorStart = "red",
            colorStop = "#8F2A18",
            heightCircularCrown = 18,
            styles = new RealTimeMap.GaugeStyle()
            {
                panel = (new LeafletForBlazor.css.Style()).add("stroke", "black").add("stroke-width", "2").add("fill", "navy").add("opacity", "0.6"),
                crown = (new LeafletForBlazor.css.Style()).add("stroke", "white").add("stroke-width", "2").add("opacity", "0.6"),
                gaugeValue = (new LeafletForBlazor.css.Style()).add("fill", "white"),
                lineIndicator = (new LeafletForBlazor.css.Style()).add("stroke", "white").add("stroke-width", "2"),
                shaft = (new LeafletForBlazor.css.Style()).add("r", "3").add("fill", "white")
            },
            fontColorStart = "white",
            fontColorMiddle = "white",
            fontColorStop = "yellow",
            fontSize = 8,
            dimension = 40,
            visibilityZoomLevel = new RealTimeMap.VisibilityZoomLevel()
            {
                minZoomLevel = 6,
                maxZoomLevel = 14
            }
        });

        var pieChart = new RealTimeMap.PieChartPoint()
        {
            location = new RealTimeMap.Location()
            {
                latitude = 51.10290763552592,
                longitude = 3.9819789339909764
            },
            values = (new List<double>() { 20, 45, 15, 20 }).ToArray(),
            colors = (new List<string>() { "#32cd32", "#ffe4c4", "#dda0dd", "pink" }).ToArray(),
            labels = (new List<string>() { "Scooter", "Bicycle", "Vehicle", "Pedest" }).ToArray(),
            expandedIndex = 0,
            fontSize = 10,
            dimension = 40,
            styles = new RealTimeMap.PieStyle()
            {
                slice = new LeafletForBlazor.css.Style().add("stroke-width", "1").add("stroke", "gray"),
                label = new LeafletForBlazor.css.Style().add("font-style", "italic"),
            },
            visibilityZoomLevel = new RealTimeMap.VisibilityZoomLevel()
            {
                minZoomLevel = 8,
                maxZoomLevel = 14
            }
        };
        await args.sender.Geometric.DisplayChartFromObject.addChartPoint(pieChart);
    

        foreach (var item in charts)
            await args.sender.Geometric.DisplayChartFromObject.addChartPoint(item);

        foreach (var item in gaugeCharts)
            await args.sender.Geometric.DisplayChartFromObject.addChartPoint(item);
    }
    private async Task clearAllCharts()
    {
        await rtm.Geometric.DisplayChartFromObject.clearAll();
    }

}