@page "/"
@using LeafletForBlazor.RealTime.points
@using clusters.Data

<RealTimeMap height="calc(100vh - 6rem)" width="calc(100vw - 18rem)" OnAfterMapLoaded="@onAfterMapLoaded"></RealTimeMap>

@code{
    DataSource dataSource = new DataSource();
    private async Task onAfterMapLoaded(RealTimeMap.MapEventArgs args)
    {
        args.sender.Geometric.Points.clusteringAfterCollectionUpdate = true;

       dataSource.pointsStart.AddRange(dataSource.pointsMore);

        await args.sender.Geometric.Points.upload(dataSource.pointsStart);
   

        args.sender.Geometric.Points.OnClusterClick += onClusterClick;
        StateHasChanged();
    }

    public void onClusterClick(object? sender, ClusteringEventArgs args)
    {
        // Handle the cluster click event
        //you receive bounds of the cluster, location of mouse click and guids
        
    }
}