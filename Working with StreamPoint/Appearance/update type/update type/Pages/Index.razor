@page "/"

@using update.Data
<button @onclick="updatePoints">Update type of first StreamPoint</button>

<RealTimeMap @ref="realTimeMap" height="calc(100vh - 6rem)" width="calc(100vw - 18rem)" OnAfterMapLoaded="@onAfterMapLoaded"></RealTimeMap>

@code {
    DataSource dataSource = new DataSource();
    RealTimeMap? realTimeMap;
    private async Task onAfterMapLoaded(RealTimeMap.MapEventArgs args)
    {
        // Initialize the data source with some points
        await args.sender.Geometric.Points.upload(dataSource.pointsStart);
        // Set the appearance for points of type "Stream Point Type"
        args.sender.Geometric.Points.Appearance((item) => item.type == "New Stream Point Type").pattern = new RealTimeMap.PointSymbol()
            {
                radius = 14,

                color = "red",
                opacity = 1,
                weight = 4,

                fillColor = "magenta",
                fillOpacity = 0.8,
            };

    }

    private async Task updatePoints()
    {//update the type of the first point in the data source
        var streamPoint = dataSource.pointsStart[0];
        streamPoint.type = "New Stream Point Type";

        // Update the type point in the StreamPoint collection and RealTimeMap
        await realTimeMap!.Geometric.Points.update(streamPoint);
        StateHasChanged();
    }
}